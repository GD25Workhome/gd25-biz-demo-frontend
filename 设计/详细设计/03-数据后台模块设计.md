# 数据后台模块设计
环境说明：本文以 macOS 开发环境为准。

## 目标
- 实现后台列表与详情页，支持分页、搜索、排序与错误处理
- 与后端接口对接，保证良好的性能与用户体验

## 接口契约（示例）
- 列表：`GET /api/items?page=<number>&size=<number>&q=<string>`
- 详情：`GET /api/items/:id`

## 状态与数据流
- 使用 React Query 管理服务器状态：
  - `queryKey = ['items', page, size, q]`
  - `queryFn` 请求后端并返回 `{ items, page, size, total }`
- 详情页：`queryKey = ['item', id]`
- 交互态（页码、搜索词、排序字段）：保存在组件局部状态或 Zustand 中

## 页面与组件
- `pages/Dashboard/ListPage.tsx`
  - 顶部搜索框与操作区（重置、导出等按需扩展）
  - 表格区域（Antd `Table`）：列定义、排序、分页
  - 加载态：`Spin`；空态：`Empty`；错误态：`Result`/`message.error`
- `components/DataTable.tsx`
  - 将表格抽象为可复用组件，接受数据源、分页信息、事件回调
- `pages/Dashboard/DetailPage.tsx`
  - 根据路由参数 `id` 拉取详情，呈现关键字段与操作按钮

## 分页/排序/搜索
- 分页：`page` 与 `size` 随用户交互更新，触发查询刷新
- 排序：在表头点击排序时，构造后端可识别的排序参数（如 `sort=createdAt,desc`）
- 搜索：输入框回车或点击“查询”触发，`q` 参与 `queryKey`

## 错误与空态
- 统一网络错误处理：Axios 拦截器规范化错误 → `message.error`
- 业务错误（如无权限）按码区分提示与降级
- 空列表展示 `Empty`，引导用户调整筛选条件

## 性能与缓存
- React Query 缓存列表数据，短时间切换分页或返回列表时避免重复请求
- 当搜索词变化时清理旧缓存或缩短 `staleTime`
- 表格大数据量时可启用虚拟滚动（Antd `VirtualList` 或第三方方案）

## 扩展方向
- 列表行内操作：编辑、删除、启用/停用
- 导出与批量操作：异步任务+通知
- 详情页 Tab：基础信息、变更记录、相关资源
