# 测试与验证方案
环境说明：本文以 macOS 开发环境为准。

## 目标
- 建立可靠的组件与服务层测试，保障核心功能质量

## 工具与环境
- 测试框架：Vitest 1.6.0
- 组件测试：@testing-library/react 14.1.2 + jsdom 24.1.0
- 断言扩展：@testing-library/jest-dom 6.2.0

## 服务层测试
- 对 `services/api/data.ts` 与 `services/api/chat.ts` 进行单元测试
- 覆盖：请求成功、错误处理、重试不命中业务错误
- 使用模拟：通过 `vi.mock('axios')` 或抽象 http 层进行桩替换

## 组件测试
- 列表页：渲染表格、分页切换触发查询、空态/错误态展示
- 聊天页：发送交互、乐观更新、轮询后消息展示与滚动
- 使用 Testing Library 查询语义化节点并断言文本与状态

## 网络模拟
- 可采用轻量桩或引入 MSW（可选，不在必需依赖中）
- 避免真实后端依赖，保持测试可重复与快速

## 覆盖率与质量门槛
- 行覆盖率目标：≥ 70%（可按迭代提升）
- 关键路径（发送消息、列表加载）需重点覆盖

## 本地运行
- 单测：`npm run test`
- 组件测试建议在 CI 中运行，并产出覆盖率报告
